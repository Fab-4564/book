<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Flipbook de Amor 3D</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      min-height: 100vh;
      margin: 0;
      background: radial-gradient(circle at center, #ffd6e8 0%, #fff0f6 100%);
      font-family: 'Georgia', serif;
      perspective: 2000px;
      overflow: hidden;
      position: relative;
      width: 100vw;
      height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .rain-photos {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      pointer-events: none;
      z-index: 1;
    }
    .rain-photos img {
      position: absolute;
      width: 12vw;
      height: 12vw;
      min-width: 60px;
      min-height: 60px;
      max-width: 140px;
      max-height: 140px;
      object-fit: cover;
      border-radius: 18px;
      box-shadow: 0 4px 24px rgba(255,77,136,0.22);
      animation: rainPhoto 7s linear infinite;
      opacity: 0.85;
    }
    @keyframes rainPhoto {
      0% { transform: translateY(-120px) rotate(-10deg);}
      90% { opacity: 0.85;}
      100% { transform: translateY(100vh) rotate(12deg); opacity: 0;}
    }
    .book {
      width: 700px;
      max-width: 98vw;
      height: 440px;
      max-height: 80vh;
      position: relative;
      border-radius: 14px;
      background: transparent;
      perspective: 2000px;
      overflow: visible;
      display: flex;
      z-index: 2;
      margin: auto;
      left: 0; right: 0; top: 0; bottom: 0;
    }
    .flip-container {
      width: 340px;
      max-width: 48vw;
      height: 440px;
      max-height: 80vh;
      position: absolute;
      top: 0;
      left: 180px;
      perspective: 2000px;
      z-index: 30;
      transition: left 1s cubic-bezier(.77,.2,.32,1.01);
    }
    .flipper {
      width: 100%;
      height: 100%;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 1s cubic-bezier(.77,.2,.32,1.01);
      cursor: pointer;
    }
    .flipper.flip {
      transform: rotateY(-180deg);
    }
    .front, .back {
      position: absolute;
      top: 0;
      left: 0;
      backface-visibility: hidden;
      border-radius: 22px;
      box-sizing: border-box;
    }
    .front {
      width: 100%;
      height: 100%;
      background: linear-gradient(120deg, #ff4d88 60%, #ff99bb 100%);
      color: white;
      font-size: 2.5vw;
      font-weight: bold;
      text-shadow: 2px 3px 16px rgba(0,0,0,0.18);
      border: 3px solid #fff0f6;
      box-shadow: 0 0 0 10px #fff0f6, 0 18px 48px rgba(255,77,136,0.22), 0 2px 8px #ff99bb;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      position: relative;
      overflow: hidden;
      border-top-left-radius: 60px 40px;
      border-bottom-right-radius: 60px 40px;
      border-bottom-left-radius: 22px;
      border-top-right-radius: 22px;
      box-shadow:
        0 0 0 10px #fff0f6,
        0 18px 48px rgba(255,77,136,0.22),
        0 2px 8px #ff99bb,
        inset 0 0 40px 0 #ff99bb66,
        0 0 60px 0 #ff4d88aa;
      padding: 2.5vw 2vw 2.5vw 2vw;
    }
    .front .shine {
      position: absolute;
      top: 0; left: 0;
      width: 100%; height: 100%;
      pointer-events: none;
      background: linear-gradient(120deg, rgba(255,255,255,0.22) 0%, rgba(255,255,255,0.09) 60%, transparent 100%);
      border-radius: 22px;
      z-index: 2;
      mix-blend-mode: screen;
    }
    .front .hearts {
      position: absolute;
      top: 2vw; left: 2vw;
      font-size: 2.5vw;
      filter: drop-shadow(0 2px 8px #ff99bb);
      z-index: 3;
      animation: float 2.5s infinite alternate;
    }
    .front .hearts2 {
      position: absolute;
      bottom: 2vw; right: 2vw;
      font-size: 2vw;
      filter: drop-shadow(0 2px 8px #ff99bb);
      z-index: 3;
      animation: float 2.2s infinite alternate-reverse;
    }
    @keyframes float {
      0% { transform: translateY(0);}
      100% { transform: translateY(-1vw);}
    }
    .front .panda {
      position: absolute;
      bottom: 0; left: 50%;
      transform: translateX(-50%);
      width: 8vw;
      height: 8vw;
      min-width: 60px;
      min-height: 60px;
      z-index: 4;
      filter: drop-shadow(0 4px 12px #ff99bb);
    }
    .front .titulo {
      font-family: 'Georgia', serif;
      letter-spacing: 2px;
      margin-bottom: 10px;
      font-size: 3vw;
      z-index: 5;
      text-shadow: 2px 2px 12px #ff99bb;
      margin-top: 2vw;
    }
    .front .subtitulo {
      font-size: 1.5vw;
      margin-top: 0.5vw;
      color: #ffe6f0;
      font-weight: normal;
      z-index: 5;
      text-shadow: 1px 1px 8px #ff99bb;
      margin-bottom: 5vw;
    }
    .front .ribbon {
      position: absolute;
      top: 0; left: 50%;
      transform: translateX(-50%);
      width: 8vw;
      min-width: 60px;
      height: 2vw;
      min-height: 24px;
      background: linear-gradient(90deg, #fff0f6 60%, #ff99bb 100%);
      border-radius: 0 0 18px 18px;
      box-shadow: 0 2px 8px #ff99bb88;
      z-index: 10;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.2vw;
      color: #ff4d88;
      font-family: 'Georgia', serif;
      font-weight: bold;
      letter-spacing: 1px;
    }
    .front .corner {
      position: absolute;
      top: 0; right: 0;
      width: 3vw; height: 3vw;
      min-width: 32px; min-height: 32px;
      background: radial-gradient(circle at 60% 40%, #fff0f6 60%, #ff99bb 100%);
      border-bottom-left-radius: 48px;
      z-index: 10;
      box-shadow: 0 2px 8px #ff99bb88;
    }
    .back {
      width: 340px;
      max-width: 48vw;
      height: 440px;
      max-height: 80vh;
      top: 0;
      left: 0;
      transform: rotateY(180deg);
      border-radius: 14px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.10);
      font-size: 2vw;
      color: #444;
      border: 1px solid #ff4d88; /* ‚Üê borde igual que interiores */
      background: #fffdf5;
      display: flex;
      justify-content: center;
      align-items: center;
      text-align: center;
    }
    .sheet {
      width: 340px;
      max-width: 48vw;
      height: 440px;
      max-height: 80vh;
      position: absolute;
      top: 0;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.5s, left 0.8s cubic-bezier(.77,.2,.32,1.01);
      box-sizing: border-box;
      padding: 2vw;
      border-radius: 14px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.10);
      font-size: 2vw;
      color: #444;
      border: 1px solid #ff4d88;   /* ‚Üê marco delgado agregado */
      background: #fffdf5;
      z-index: 10;
    }
    .sheet.visible { opacity: 1; visibility: visible; }
    .sheet.left { left: 0; }
    .sheet.right { left: 360px; }
    .sheet.end {
      background: linear-gradient(135deg, #fffdf5 80%, #ffd6e8 100%);
      color: #444;
      font-size: 2vw;
      font-weight: bold;
      border: 2px solid #ff99bb;
      cursor: pointer;
    }
    .arrow-btn {
      position: absolute;
      bottom: 1vw;
      right: 1vw;
      background: #ff4d88;
      color: #fff;
      border: none;
      border-radius: 50%;
      width: 2.5vw;
      height: 2.5vw;
      min-width: 32px;
      min-height: 32px;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 1.5vw;
      cursor: pointer;
      box-shadow: 0 2px 8px rgba(255,77,136,0.18);
      transition: background 0.2s;
      z-index: 2;
    }
    .arrow-btn:active { background: #ff99bb; }

    /* Palabras explosi√≥n */
    .explosion-word {
      position: fixed;
      font-size: 32px;
      font-weight: bold;
      color: #ff4d88;
      font-family: 'Georgia', serif;
      pointer-events: none;
      animation: explode 1s ease-out forwards;
      white-space: nowrap;
      z-index: 2000;
      text-shadow: 2px 2px 8px #ff99bb;
    }
    @keyframes explode {
      0%   { transform: scale(0.2) translate(0,0); opacity: 1; }
      50%  { transform: scale(1.4) translate(var(--x), var(--y)); opacity: 1; }
      100% { transform: scale(1.8) translate(calc(var(--x) * 1.3), calc(var(--y) * 1.3)); opacity: 0; }
    }

    /* üîπ Para m√≥viles */
    @media (max-width: 600px) {
      .book {
        width: 98vw;
        height: 62vw;
        min-height: 220px;
        margin: auto;
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
      }
      .flip-container {
        width: 47vw;
        height: 62vw;
        min-width: 120px;
        max-width: 49vw;
        max-height: 80vh;
        left: 25vw;
        margin: 0;
        position: absolute;
        top: 0;
        z-index: 30;
        transition: left 1s cubic-bezier(.77,.2,.32,1.01);
      }
      .sheet.right { left: 49vw !important; }
      .sheet.left { left: 0 !important; }

      /* Escalado inverso: a menor ancho, mayor tama√±o de letra */
      /* F√≥rmula: combina vw con (600px - 100vw) para que al reducir ancho la parte adicional aumente */
      .sheet {
        width: 47vw;
        height: 62vw;
        min-width: 120px;
        max-width: 49vw;
        max-height: 80vh;
        border-radius: 10px;
        font-size: calc(3.2vw + (600px - 100vw) * 0.04); /* <- aqu√≠ est√° el comportamiento pedido */
        padding: 3vw;
      }

      /* Ajustes espec√≠ficos de portada para que los t√≠tulos tambi√©n crezcan al reducir ancho */
      .front .titulo {
        font-size: calc(4.5vw + (600px - 100vw) * 0.06);
      }
      .front .subtitulo {
        font-size: calc(2.2vw + (600px - 100vw) * 0.04);
      }

      .back {
        width: 47vw;
        height: 62vw;
        min-width: 120px;
        max-width: 49vw;
        max-height: 80vh;
        left: 0;
        border-radius: 10px;
        font-size: calc(3.2vw + (600px - 100vw) * 0.04);
      }
    }
    #flipPortada { z-index: 10; }
    #sheet1 { z-index: 20; }
    #sheet2 { z-index: 30; }
    #sheet3 { z-index: 30; }
    #sheet4 { z-index: 30; }
    #sheet5 { z-index: 30; }
    #sheet6 { z-index: 30; }
    #sheet7 { z-index: 30; }
    #sheet8 { z-index: 30; }
    #sheet9 { z-index: 30; }
    #sheet10 { z-index: 30; }
    #sheet11 { z-index: 10; }
  </style>
</head>
<body>
  <div class="rain-photos" id="rainPhotos"></div>
  <div class="book" id="book">
    <!-- Portada -->
    <div class="flip-container" id="flipPortada">
      <div class="flipper" id="flipper" onclick="abrirPortada()">
        <div class="front">
          <span class="ribbon">Te amo</span>
          <span class="corner"></span>
          <span class="hearts">üíñüíó</span>
          <span class="hearts2">üíûüíï</span>
          <div class="shine"></div>
          <div class="titulo">Nuestro Amor</div>
          <div class="subtitulo">Un viaje de sentimientos</div>
        </div>
        <div class="back">
          Para ti, con todo mi amor üíå
        </div>
      </div>
    </div>

    <!-- P√°ginas (existentes + nuevas) -->
    <div class="sheet right" id="sheet1">
      <strong>Cap√≠tulo 1:</strong> El Encuentro<br><br>
      Desde la primera vez que te vi, supe que era algo especial. <br>
      <span style="font-size:32px;">üòç</span>
      <button class="arrow-btn" onclick="nextBookPage(); event.stopPropagation();">&#8594;</button>
    </div>

    <div class="sheet left" id="sheet2">
      <strong>Cap√≠tulo 2:</strong> Los Momentos<br><br>
      Cada sonrisa, cada abrazo y cada palabra han llenado mi vida de alegr√≠a.<br>
      <span style="font-size:32px;">ü§ó</span>
    </div>

    <div class="sheet right" id="sheet3">
      <strong>Cap√≠tulo 3:</strong> El Futuro<br><br>
      Quiero escribir esta historia contigo, cada d√≠a, cada a√±o, por siempre.<br>
      <span style="font-size:32px;">üíç</span>
      <button class="arrow-btn" onclick="nextBookPage(); event.stopPropagation();">&#8594;</button>
    </div>

    <div class="sheet left" id="sheet4">
      <strong>Cap√≠tulo 4:</strong> Nuestros Sue√±os<br><br>
      Juntos hemos alcanzado metas que jam√°s imagin√©.<br>
      <span style="font-size:32px;">üåü</span>
    </div>

    <div class="sheet right" id="sheet5">
      <strong>Cap√≠tulo 5:</strong> Peque√±as cosas<br><br>
      Esas peque√±as rutinas son mi felicidad cotidiana.<br>
      <span style="font-size:32px;">‚òïÔ∏è</span>
      <button class="arrow-btn" onclick="nextBookPage(); event.stopPropagation();">&#8594;</button>
    </div>

    <div class="sheet left" id="sheet6">
      <strong>Cap√≠tulo 6:</strong> Aventuras<br><br>
      Recordando viajes, risas y promesas bajo las estrellas.<br>
      <span style="font-size:32px;">‚úàÔ∏è</span>
    </div>

    <div class="sheet right" id="sheet7">
      <strong>Cap√≠tulo 7:</strong> Lecciones<br><br>
      Aprendimos a ser mejores, juntos en lo bueno y en lo dif√≠cil.<br>
      <span style="font-size:32px;">üìö</span>
      <button class="arrow-btn" onclick="nextBookPage(); event.stopPropagation();">&#8594;</button>
    </div>

    <div class="sheet left" id="sheet8">
      <strong>Cap√≠tulo 8:</strong> Risue√±os<br><br>
      Las tonter√≠as que nos hacen re√≠r todav√≠a me sacan mariposas.<br>
      <span style="font-size:32px;">üòÇ</span>
    </div>

    <div class="sheet right" id="sheet9">
      <strong>Cap√≠tulo 9:</strong> Cimientos<br><br>
      Construimos un hogar de confianza, respeto y cari√±o.<br>
      <span style="font-size:32px;">üè†</span>
      <button class="arrow-btn" onclick="nextBookPage(); event.stopPropagation();">&#8594;</button>
    </div>

    <div class="sheet left" id="sheet10">
      <strong>Cap√≠tulo 10:</strong> Promesas<br><br>
      Prometo cuidarte, escucharte y caminar a tu lado cada d√≠a.<br>
      <span style="font-size:32px;">ü§ù</span>
    </div>

    <!-- P√°gina final -->
    <div class="sheet end right" id="sheet11" onclick="goToCover()">
      Gracias por ser mi gran amor üíñ
    </div>
  </div>

  <audio id="music" src="lmuchachita.mp3"></audio>

  <script>
    // Actualizamos los pares para incluir la nueva p√°gina sheet10 y la final sheet11
    let currentPair = -1;
    const pairs = [
      ["sheet2","sheet3"],
      ["sheet4","sheet5"],
      ["sheet6","sheet7"],
      ["sheet8","sheet9"],
      ["sheet10","sheet11"]
    ];

    function abrirPortada() {
      document.getElementById('flipper').classList.add('flip');
      setTimeout(() => {
        document.getElementById('flipPortada').style.left = "0px";
        document.getElementById('sheet1').classList.add('visible');
        currentPair = 0;
        const music = document.getElementById("music");
        const p = music.play();
        if (p && p.catch) p.catch(() => { /* reproducci√≥n bloqueada hasta interacci√≥n extra */ });
      }, 1000);
    }

    function nextBookPage() {
      if (currentPair < pairs.length) {
        if (currentPair === 0) {
          document.getElementById('sheet1').classList.remove('visible');
        } else {
          const prev = pairs[currentPair-1];
          if (prev && prev[0]) document.getElementById(prev[0]).classList.remove('visible');
          if (prev && prev[1]) document.getElementById(prev[1]).classList.remove('visible');
        }
        if (currentPair < pairs.length) {
          const cur = pairs[currentPair];
          if (cur && cur[0]) document.getElementById(cur[0]).classList.add('visible');
          if (cur && cur[1]) document.getElementById(cur[1]).classList.add('visible');
          currentPair++;
        }
      }
    }

    function goToCover() {
      document.querySelectorAll(".sheet").forEach(s => s.classList.remove("visible"));
      document.getElementById('flipper').classList.remove('flip');
      // CENTRAR la portada en m√≥vil y devolver a 180px en escritorio
      const flipPortada = document.getElementById('flipPortada');
      if (window.innerWidth <= 600) {
        flipPortada.style.left = "25vw"; // centro aproximado para la vista m√≥vil (coincide con .flip-container en CSS)
      } else {
        flipPortada.style.left = "180px";
      }
      currentPair = -1;
      const music = document.getElementById("music");
      if (!music.paused) music.pause();
      music.currentTime = 0;
    }

    // Lluvia de fotos
    const images = ["foto1.jpg", "foto2.jpg", "foto3.jpg"];
    function createRainPhoto() {
      const rain = document.getElementById("rainPhotos");
      const img = document.createElement("img");
      img.src = images[Math.floor(Math.random() * images.length)];
      img.style.left = Math.random() * 100 + "vw";
      img.style.top = "-120px";
      rain.appendChild(img);
      setTimeout(() => img.remove(), 7000);
    }
    setInterval(createRainPhoto, 1000);

    // Palabras de explosi√≥n
    const palabras = ["Te amo", "Eres mi todo", "Siempre juntos"];
    function explosionDePalabras(x, y) {
      palabras.forEach((p, i) => {
        const span = document.createElement("span");
        span.className = "explosion-word";
        span.textContent = p;
        span.style.left = x + "px";
        span.style.top = y + "px";
        span.style.setProperty("--x", (Math.random() * 200 - 100) + "px");
        span.style.setProperty("--y", (Math.random() * 200 - 100) + "px");
        document.body.appendChild(span);
        setTimeout(() => span.remove(), 1000);
      });
    }

    // Detectar clic fuera del libro
    document.addEventListener("click", (e) => {
      const book = document.getElementById("book");
      if (!book.contains(e.target)) {
        explosionDePalabras(e.clientX, e.clientY);
      }
    });

    // Si redimensionan la ventana mientras est√° en portada, aseguramos posici√≥n correcta
    window.addEventListener('resize', () => {
      // Si estamos en estado portada (flipper sin flip y sin sheets visibles) colocar en centro en m√≥vil
      const flipPortada = document.getElementById('flipPortada');
      const anyVisibleSheet = Array.from(document.querySelectorAll('.sheet')).some(s => s.classList.contains('visible'));
      const flipper = document.getElementById('flipper');
      const isFlipped = flipper.classList.contains('flip');
      if (!anyVisibleSheet && !isFlipped) {
        if (window.innerWidth <= 600) {
          flipPortada.style.left = '25vw';
        } else {
          flipPortada.style.left = '180px';
        }
      }
    });
  </script>
</body>
</html>


